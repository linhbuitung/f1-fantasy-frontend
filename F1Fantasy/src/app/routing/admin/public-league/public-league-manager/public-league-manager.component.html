
  <div class="public-league-manager">
    <div class="row gx-4">
      <aside class="col-lg-4 col-12">
        <div class="card sidebar-card">
          <div class="card-header">Find public leagues</div>
          <div class="card-body">
            <form [formGroup]="searchForm" (submit)="$event.preventDefault(); onSearch()">
              <div class="mb-2">
                <input type="text" class="form-control" placeholder="Search by name" formControlName="query" />
              </div>
              <div class="d-grid">
                <button class="btn btn-search btn-sm" type="button" (click)="onSearch()">Search</button>
              </div>
            </form>

            <div class="mt-3">
              <div *ngIf="loading" class="text-center my-3">
                <div class="spinner-border text-primary" role="status"></div>
              </div>
              <div *ngIf="!loading && results.length === 0" class="text-muted small">No results</div>

              <div *ngFor="let l of results" class="list-item d-flex justify-content-between align-items-center mb-2">
                <div>
                  <div class="fw-semibold">{{ l.name }}</div>
                  <div class="small text-muted">{{ l.totalPlayersNum }} players â€¢ {{ l.type }}</div>
                </div>
                <div>
                  <button class="btn btn-sm btn-edit me-1" (click)="select(l)">Edit</button>
                </div>
              </div>

              <nav *ngIf="total > pageSize" class="mt-3">
                <ul class="pagination justify-content-center">
                  <li class="page-item" [class.disabled]="pageNum === 1">
                    <button class="page-link" (click)="onPageChange(pageNum - 1)" [disabled]="pageNum === 1">Previous</button>
                  </li>
                  <li class="page-item disabled"><span class="page-link">Page {{ pageNum }} of {{ Math.ceil(total / pageSize) }}</span></li>
                  <li class="page-item" [class.disabled]="pageNum >= Math.ceil(total / pageSize)">
                    <button class="page-link" (click)="onPageChange(pageNum + 1)" [disabled]="pageNum >= Math.ceil(total / pageSize)">Next</button>
                  </li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </aside>

      <main class="col-lg-8 col-12">
        <div class="card content-card">
          <div class="card-header">Manage public league</div>
          <div class="card-body">
            <div *ngIf="!selectedLeague" class="text-muted">Select a league on the left to edit or delete.</div>

            <div *ngIf="selectedLeague">
              <form [formGroup]="editForm" (ngSubmit)="onUpdate()">
                <div class="mb-2 row">
                  <label class="col-sm-4 col-form-label">Name</label>
                  <div class="col-sm-8">
                    <input type="text" formControlName="name" class="form-control" maxlength="200" />
                  </div>
                </div>

                <div class=" row mb-2">
                  <label class="col-sm-4 col-form-label">Max Players</label>
                  <div class="col-sm-8 d-flex align-items-center">
                    <span class="form-control-plaintext">{{ selectedLeague?.maxPlayersNum || 'N/A' }}</span>
                  </div>
                </div>

                <div class="mb-3 row">
                  <label class="col-sm-4 col-form-label">Description</label>
                  <div class="col-sm-8">
                    <textarea formControlName="description" class="form-control" rows="3" maxlength="500"></textarea>
                  </div>
                </div>

                <div class="d-flex gap-2">
                  <button type="submit" class="btn btn-save" [disabled]="editForm.invalid || submitting">
                    {{ submitting ? 'Saving...' : 'Save changes' }}
                  </button>
                  <button type="button" class="btn btn-delete" (click)="showDeleteConfirm = true" [disabled]="deleting">
                    {{ deleting ? 'Deleting...' : 'Delete league' }}
                  </button>
                  <button type="button" class="btn close-btn" (click)="select(null)">Close</button>
                </div>
              </form>

              <div *ngIf="serverError" class="alert alert-danger mt-3">{{ serverError }}</div>
              <div *ngIf="successMessage" class="alert alert-success mt-3">{{ successMessage }}</div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <app-confirm-modal
      [show]="showDeleteConfirm"
      title="Confirm Deletion"
      [message]="'Are you sure you want to delete the league ' + (selectedLeague?.name || '') + '? This action cannot be undone.'"
      confirmText="Delete"
      cancelText="Cancel"
      confirmIcon="fa-solid fa-trash"
      [loading]="deleting"
      (confirm)="onDeleteLeague()"
      (cancel)="showDeleteConfirm = false"
    ></app-confirm-modal>
  </div>
